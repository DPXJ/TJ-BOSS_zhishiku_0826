<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒè¯•æµ‹è¯•é¡µé¢</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        button { padding: 10px 20px; margin: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
        .log { background: #f8f9fa; padding: 10px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>è°ƒè¯•æµ‹è¯•é¡µé¢</h1>
    
    <div class="debug-section">
        <h2>å½“å‰çŠ¶æ€æ£€æŸ¥</h2>
        <button onclick="checkAppState()">æ£€æŸ¥appState</button>
        <button onclick="checkFunctions()">æ£€æŸ¥å‡½æ•°</button>
        <button onclick="simulateFileUpload()">æ¨¡æ‹Ÿæ–‡ä»¶ä¸Šä¼ </button>
        <button onclick="testPerformStyleAnalysis()">æµ‹è¯•performStyleAnalysis</button>
    </div>
    
    <div class="debug-section">
        <h2>è°ƒè¯•æ—¥å¿—</h2>
        <div id="debug-log" class="log"></div>
    </div>
    
    <script>
        // ç®€åŒ–çš„appStateç”¨äºæµ‹è¯•
        const appState = {
            uploadedFiles: [],
            urls: [],
            fileUrls: [],
            styleOutput: null,
            generatedContent: null,
            isUploading: false,
            isAnalyzing: false,
            isGenerating: false,
            chatId: null
        };
        
        function log(message) {
            const logDiv = document.getElementById('debug-log');
            logDiv.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
            console.log(message);
        }
        
        function checkAppState() {
            log('ğŸ” æ£€æŸ¥appState:');
            log('- fileUrls: ' + JSON.stringify(appState.fileUrls));
            log('- urls: ' + JSON.stringify(appState.urls));
            log('- uploadedFiles: ' + JSON.stringify(appState.uploadedFiles));
            log('- isAnalyzing: ' + appState.isAnalyzing);
        }
        
        function checkFunctions() {
            log('ğŸ” æ£€æŸ¥å‡½æ•°æ˜¯å¦å­˜åœ¨:');
            log('- typeof performStyleAnalysis: ' + typeof performStyleAnalysis);
            log('- typeof collectAllUrls: ' + typeof collectAllUrls);
            log('- typeof checkLearningButtonStatus: ' + typeof checkLearningButtonStatus);
        }
        
        function simulateFileUpload() {
            log('ğŸ” æ¨¡æ‹Ÿæ–‡ä»¶ä¸Šä¼ :');
            appState.fileUrls = ['https://example.com/test1.pdf', 'https://example.com/test2.docx'];
            appState.uploadedFiles = [
                { name: 'test1.pdf', type: 'pdf', size: 1024, url: 'https://example.com/test1.pdf' },
                { name: 'test2.docx', type: 'word', size: 2048, url: 'https://example.com/test2.docx' }
            ];
            log('- æ¨¡æ‹Ÿä¸Šä¼ å®Œæˆ');
            checkAppState();
        }
        
        function testPerformStyleAnalysis() {
            log('ğŸ” æµ‹è¯•performStyleAnalysiså‡½æ•°:');
            if (typeof performStyleAnalysis === 'function') {
                try {
                    performStyleAnalysis();
                    log('- å‡½æ•°è°ƒç”¨æˆåŠŸ');
                } catch (error) {
                    log('- å‡½æ•°è°ƒç”¨å¤±è´¥: ' + error.message);
                }
            } else {
                log('- performStyleAnalysiså‡½æ•°ä¸å­˜åœ¨');
            }
        }
        
        // ç®€åŒ–çš„collectAllUrlså‡½æ•°
        function collectAllUrls() {
            log('ğŸ” collectAllUrlsè¢«è°ƒç”¨');
        }
        
        // ç®€åŒ–çš„checkLearningButtonStatuså‡½æ•°
        function checkLearningButtonStatus() {
            log('ğŸ” checkLearningButtonStatusè¢«è°ƒç”¨');
        }
        
        // ç®€åŒ–çš„performStyleAnalysiså‡½æ•°ç”¨äºæµ‹è¯•
        function performStyleAnalysis() {
            log('ğŸ” performStyleAnalysiså‡½æ•°å¼€å§‹æ‰§è¡Œ');
            log('ğŸ” å½“å‰ appState.fileUrls: ' + JSON.stringify(appState.fileUrls));
            log('ğŸ” å½“å‰ appState.urls: ' + JSON.stringify(appState.urls));
            
            collectAllUrls();
            
            if (!Array.isArray(appState.fileUrls)) appState.fileUrls = [];
            if (!Array.isArray(appState.urls)) appState.urls = [];
            const article_input = Array.isArray(appState.fileUrls) ? [...appState.fileUrls] : [];
            const url_input = Array.isArray(appState.urls) ? [...appState.urls] : [];
            
            log('ğŸ” å¤„ç†åçš„å˜é‡:');
            log('ğŸ” article_input: ' + JSON.stringify(article_input));
            log('ğŸ” url_input: ' + JSON.stringify(url_input));
            log('ğŸ” article_input.length: ' + article_input.length);
            log('ğŸ” url_input.length: ' + url_input.length);
            
            if (article_input.length === 0 && url_input.length === 0) {
                log('ğŸ” æ²¡æœ‰æ–‡ä»¶å’Œé“¾æ¥ï¼Œé€€å‡ºå‡½æ•°');
                return;
            }
            
            log('ğŸ” å¼€å§‹é£æ ¼åˆ†ææµç¨‹');
            appState.isAnalyzing = true;
            
            // æ¨¡æ‹ŸAPIè°ƒç”¨
            setTimeout(() => {
                log('ğŸ” æ¨¡æ‹ŸAPIè°ƒç”¨å®Œæˆ');
                appState.isAnalyzing = false;
            }, 2000);
        }
    </script>
</body>
</html> 