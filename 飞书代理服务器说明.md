# 飞书API代理服务器使用说明

## 问题描述
由于浏览器的CORS（跨域资源共享）安全策略，直接从本地网页调用飞书API会被阻止。为了解决这个问题，我们创建了一个本地代理服务器。

## 解决方案
通过在本地运行一个Node.js代理服务器，将飞书API请求转发到官方API，从而绕过CORS限制。

## 使用步骤

### 1. 安装依赖
确保您的系统已安装Node.js，然后运行：
```bash
npm install express cors node-fetch
```

### 2. 启动代理服务器
双击运行 `start-feishu-proxy.bat` 文件，或在命令行中运行：
```bash
node feishu-proxy-server.js
```

### 3. 验证服务器状态
代理服务器启动后，访问：http://localhost:3002/health
看到 `{"status":"ok","message":"飞书代理服务器运行正常"}` 即表示成功。

### 4. 配置飞书信息
在主应用中配置您的飞书App ID、App Secret等信息。

### 5. 测试同步功能
现在您可以正常使用飞书同步功能了。

## 技术说明
- 代理服务器监听端口：3002
- 代理路径格式：`http://localhost:3002/feishu-proxy/*`
- 自动转发所有请求头和请求体到飞书官方API
- 支持所有HTTP方法（GET、POST、PATCH等）

## 常见问题

### Q: 代理服务器启动失败
A: 检查端口3002是否被占用，或安装所需的依赖包。

### Q: 同步仍然失败
A: 确保代理服务器正在运行，并检查飞书配置信息是否正确。

### Q: 端口冲突
A: 如需修改端口，请编辑 `feishu-proxy-server.js` 文件中的 `PORT` 变量，并同时修改 `script.js` 中的对应URL。

## 安全说明
- 代理服务器仅在本地运行，不会暴露给外网
- 所有API请求都直接转发给飞书官方服务器
- 不存储任何敏感信息
